# ูุฑูุช ุฐุฎุฑูโุณุงุฒ ูุฑุงุฑุฏุงุฏูุง - Storage Format Documentation

## ูุญูู ุฐุฎุฑูโุณุงุฒ

ููฺฏุงู ฺฉู ฺฉ ูุฑุงุฑุฏุงุฏ ุซุจุช ูโุดูุฏุ ุงุทูุงุนุงุช ุจู ุดฺฉู ุฒุฑ ุฐุฎุฑู ูโฺฏุฑุฏุฏ:

---

## ๐ ุฏุชุงุจุณ MySQL

### ุฌุฏูู: `wp_cooperation_contracts`

ุชูุงู ูุฑุงุฑุฏุงุฏูุง ุฏุฑ ฺฉ ุฌุฏูู MySQL ุจุง ุณุงุฎุชุงุฑ ุฒุฑ ุฐุฎุฑู ูโุดููุฏ:

| ุณุชูู | ููุน | ุชูุถุญุงุช |
|------|-----|---------|
| `id` | mediumint(9) | ุดูุงุณู ฺฉุชุง ูุฑุงุฑุฏุงุฏ (Auto Increment) |
| `first_name` | varchar(100) | ูุงู ูุฑุฏ |
| `last_name` | varchar(100) | ูุงู ุฎุงููุงุฏฺฏ ูุฑุฏ |
| `national_id` | varchar(10) | ฺฉุฏ ูู 10 ุฑูู |
| `institution_name` | varchar(255) | ูุงู ุขููุฒุดฺฏุงู ุง ุณุงุฒูุงู |
| `position` | varchar(100) | ุณูุช ุง ุนููุงู ุดุบู |
| `address` | text | ุขุฏุฑุณ ฺฉุงูู |
| `contract_date` | varchar(50) | ุชุงุฑุฎ ูุฑุงุฑุฏุงุฏ (ุดูุณุ ูุฑูุช: YYYY/MM/DD) |
| `selected_plan` | varchar(50) | ุทุฑุญ ุงูุชุฎุงุจ (ุทุฑุญ ุณุงุช / ุทุฑุญ ฺฏุฑูู / ุทุฑุญ ุทูุง) |
| `signature_data` | longtext | ุฏุงุฏู ุงูุถุง ุฏุฌุชุงู (Base64) |
| `created_at` | datetime | ุฒูุงู ุซุจุช ูุฑุงุฑุฏุงุฏ (ุชุงุฑุฎ ููุงุฏ) |
| `user_id` | bigint(20) | ุดูุงุณู ฺฉุงุฑุจุฑ ูุฑุฏูพุฑุณ (ุฏุฑ ุตูุฑุช ูุฑูุฏ) |
| `ip_address` | varchar(45) | ุขุฏุฑุณ IP ุซุจุชโฺฉููุฏู |

---

## ๐๏ธ ูุฑูุช ุงูุถุง ุฏุฌุชุงู

### ุฐุฎุฑูโุณุงุฒ:
ุงูุถุง ุจู ุตูุฑุช **Data URL (Base64)** ุฐุฎุฑู ูโุดูุฏ:

```
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA...
```

### ูุดุฎุตุงุช:
- **ูุฑูุช ุชุตูุฑ**: PNG
- **ฺฉุฏฺฏุฐุงุฑ**: Base64
- **ูพุณโุฒููู**: ุณูุฏ (RGB: 255, 255, 255)
- **ุฑูฺฏ ุฎุท ุงูุถุง**: ูุดฺฉ (RGB: 0, 0, 0)
- **ฺฉูุช**: HD (ุชุทุจู ุจุง DPI ุตูุญู)

### ุญุฌู ุชูุฑุจ:
- ุงูุถุง ุณุงุฏู: 5-15 KB
- ุงูุถุง ูพฺุฏู: 15-50 KB

---

## ๐ ูุฑูุช ุชุงุฑุฎ

### ุชุงุฑุฎ ูุฑุงุฑุฏุงุฏ (`contract_date`):
```
ูุฑูุช: YYYY/MM/DD (ุดูุณ)
ูุซุงู: 1403/08/01
```

### ุชุงุฑุฎ ุซุจุช (`created_at`):
```
ูุฑูุช: YYYY-MM-DD HH:MM:SS (ููุงุฏ)
ูุซุงู: 2025-10-19 14:30:25
```

---

## ๐พ ููููู ุฑฺฉูุฑุฏ

```sql
INSERT INTO wp_cooperation_contracts VALUES (
    1,                                  -- id
    'ุนู',                             -- first_name
    'ูุญูุฏ',                           -- last_name
    '1234567890',                      -- national_id
    'ุขููุฒุดฺฏุงู ุนูู ู ุฏุงูุด',            -- institution_name
    'ูุฏุฑ ุขููุฒุด',                      -- position
    'ุชูุฑุงูุ ุฎุงุจุงู ููุนุตุฑุ ูพูุงฺฉ 123', -- address
    '1403/08/01',                      -- contract_date
    'ุทุฑุญ ฺฏุฑูู',                        -- selected_plan
    'data:image/png;base64,iVBOR...',  -- signature_data
    '2025-10-19 14:30:25',            -- created_at
    5,                                 -- user_id (ุง NULL)
    '192.168.1.1'                      -- ip_address
);
```

---

## ๐ ุงุณุชุฎุฑุงุฌ ู ุจุงุฒุงุจ ุฏุงุฏูโูุง

### ุฑูุด 1: ุงุฒ ุทุฑู ูพูู ูุฏุฑุช ูุฑุฏูพุฑุณ
```
ุฏุงุดุจูุฑุฏ โ ูุฑุงุฑุฏุงุฏูุง ููฺฉุงุฑ โ ูุดุงูุฏู
```

### ุฑูุด 2: Query ูุณุชูู MySQL
```sql
SELECT 
    id,
    CONCAT(first_name, ' ', last_name) AS full_name,
    national_id,
    institution_name,
    position,
    contract_date,
    selected_plan,
    created_at
FROM wp_cooperation_contracts
ORDER BY created_at DESC;
```

### ุฑูุด 3: Export ุงูุถุง ุจู ูุงู ุชุตูุฑ

ุงูุถุง ุฑุง ูโุชูุงู ุจู ุงู ุฑูุด ุงุณุชุฎุฑุงุฌ ฺฉุฑุฏ:

```php
<?php
// ุฏุฑุงูุช ุงูุถุง ุงุฒ ุฏุชุงุจุณ
$signature_base64 = $contract->signature_data;

// ุญุฐู prefix
$image_data = str_replace('data:image/png;base64,', '', $signature_base64);
$image_data = base64_decode($image_data);

// ุฐุฎุฑู ุจู ูุงู
file_put_contents('signature_' . $contract->id . '.png', $image_data);
?>
```

---

## ๐ค Export ู Backup

### Backup ุฏุชุงุจุณ:
```bash
mysqldump -u username -p database_name wp_cooperation_contracts > contracts_backup.sql
```

### Export ุจู CSV:
ุงุฒ ูพูู phpMyAdmin ุง ุจุง query ุฒุฑ:

```sql
SELECT 
    id,
    first_name,
    last_name,
    national_id,
    institution_name,
    position,
    address,
    contract_date,
    selected_plan,
    created_at,
    ip_address
FROM wp_cooperation_contracts
INTO OUTFILE '/tmp/contracts.csv'
FIELDS TERMINATED BY ',' 
ENCLOSED BY '"'
LINES TERMINATED BY '\n';
```

**ุชูุฌู**: ุงูุถุงูุง ุฏุฑ CSV ุฐุฎุฑู ููโุดููุฏ. ุจุฑุง Export ุงูุถุงูุง ุจุงุฏ ุงุฒ ุฑูุดโูุง ุฏฺฏุฑ ุงุณุชูุงุฏู ุดูุฏ.

---

## ๐ ุงููุช ุฏุงุฏูโูุง

### ุฑูุฒูฺฏุงุฑ:
- ุฏุงุฏูโูุง ุฏุฑ ุฏุชุงุจุณ ุจู ุตูุฑุช Plain Text ุฐุฎุฑู ูโุดููุฏ
- ุจุฑุง ุงููุช ุจุดุชุฑุ ุงุฒ SSL/TLS ุจุฑุง ุงุชุตุงู ุฏุชุงุจุณ ุงุณุชูุงุฏู ฺฉูุฏ

### ูุญุงูุธุช:
- ุชูุงู ูุฑูุฏโูุง Sanitize ูโุดููุฏ
- ุงุฒ Prepared Statements ุงุณุชูุงุฏู ูโุดูุฏ
- ุขุฏุฑุณ IP ุจุฑุง Audit Trail ุฐุฎุฑู ูโุดูุฏ

### ุชูุตูโูุง:
1. Backup ููุธู ุงุฒ ุฏุชุงุจุณ
2. ูุญุฏูุฏ ฺฉุฑุฏู ุฏุณุชุฑุณ ุจู ุฌุฏูู
3. ุงุณุชูุงุฏู ุงุฒ HTTPS ุจุฑุง ุณุงุช
4. ูุงฺฏโฺฏุฑ ุงุฒ ุชุบุฑุงุช

---

## ๐ฆ ุญุฌู ุฐุฎุฑูโุณุงุฒ

### ุชุฎูู ูุถุง ููุฑุฏ ูุงุฒ:

**ูุฑ ูุฑุงุฑุฏุงุฏ**:
- ูุชูโูุง (ุจุฏูู ุงูุถุง): ~1-2 KB
- ุงูุถุง ุฏุฌุชุงู: ~10-30 KB
- **ูุฌููุน**: ~15-35 KB

**1000 ูุฑุงุฑุฏุงุฏ**:
- ูุถุง ููุฑุฏ ูุงุฒ: ~15-35 MB

**10,000 ูุฑุงุฑุฏุงุฏ**:
- ูุถุง ููุฑุฏ ูุงุฒ: ~150-350 MB

---

## ๐ Migration ู ุงูุชูุงู ุฏุงุฏู

ุจุฑุง ุงูุชูุงู ูุฑุงุฑุฏุงุฏูุง ุจู ุณุฑูุฑ ุฏฺฏุฑ:

```sql
-- Export
mysqldump -u username -p --tables wp_cooperation_contracts > contracts.sql

-- Import ุฏุฑ ุณุฑูุฑ ุฌุฏุฏ
mysql -u username -p database_name < contracts.sql
```

---

## ๐ ฺฏุฒุงุฑุดโฺฏุฑ

### ุชุนุฏุงุฏ ฺฉู ูุฑุงุฑุฏุงุฏูุง:
```sql
SELECT COUNT(*) FROM wp_cooperation_contracts;
```

### ูุฑุงุฑุฏุงุฏูุง ุงูุฑูุฒ:
```sql
SELECT * FROM wp_cooperation_contracts 
WHERE DATE(created_at) = CURDATE();
```

### ุขูุงุฑ ุจุฑ ุงุณุงุณ ุทุฑุญ:
```sql
SELECT selected_plan, COUNT(*) as count 
FROM wp_cooperation_contracts 
GROUP BY selected_plan;
```

---

## ๐ก ูฺฉุงุช ููู

1. **ุงูุถุงูุง ุญุฌู ุฒุงุฏ ุฏุงุฑูุฏ**: ุฏุฑ ูุธุฑ ุจฺฏุฑุฏ ฺฉู longtext ูโุชูุงูุฏ ุชุง 4GB ุฏุงุฏู ูฺฏู ุฏุงุฑุฏ
2. **Index**: ุจุฑุง ุฌุณุชุฌู ุณุฑุนโุชุฑุ ูโุชูุงูุฏ Index ุฑู `national_id` ู `created_at` ุจฺฏุฐุงุฑุฏ
3. **Cleanup**: ูุฑุงุฑุฏุงุฏูุง ูุฏู ุฑุง Archive ฺฉูุฏ ุชุง ุนููฺฉุฑุฏ ุฏุชุงุจุณ ุจูุชุฑ ุดูุฏ
4. **Privacy**: ุฏุงุฏูโูุง ุดุฎุต (ฺฉุฏ ูู) ูุญุฑูุงูู ูุณุชูุฏ - ุฑุนุงุช GDPR ู ููุงูู ุญูุงุธุช ุงุฒ ุฏุงุฏูโูุง

---

## ๐๏ธ ุชูุณุนู ู ุณูุงุฑุดโุณุงุฒ

ุจุฑุง ุงุถุงูู ฺฉุฑุฏู ููุฏูุง ุฌุฏุฏ:

1. ุชุบุฑ Schema ุฏุฑ `includes/class-database.php`
2. ุงุถุงูู ฺฉุฑุฏู ุจู ูุฑู ุฏุฑ `includes/class-frontend.php`
3. ุขูพุฏุช ูุชุฏ `save_contract()`
4. ุบุฑูุนุงู ู ูุนุงู ูุฌุฏุฏ ุงูุฒููู ุจุฑุง ุงุฌุฑุง Migration

---

**ุชุงุฑุฎ ุจูโุฑูุฒุฑุณุงู**: 1403/08/01
